<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<style type="text/css">
	/*#controller {position: absolute}*/
	/*#imageClick {position: absolute}*/
	#dsImage {
		height: 100%;
		width: 100%;
	}
</style>
<body>
	<div id="imageContainer"><img src="{{newImage}}" id="dsImage"></div>
	<div id="controller">
		<form name="inputForm" id="inputForm">
			<label>x_low</label>
			<input type="text" name="x_low" id="x_low" value="{{x_low}}"/>
			<label>y_low</label>
			<input type="text" name="y_low" id="y_low" value="{{y_low}}"/>
			<label>x_high</label>
			<input type="text" name="x_high" id="x_high" value="{{x_high}}"/>
			<label>y_high</label>
			<input type="text" name="y_high" id="y_high" value="{{y_high}}"/>
			<button id="changeGraph" type="submit">Zoom button</button>
		</form>
	</div>
	<div id="imageClick"></div>
	<script type="text/javascript">
	$(document).ready(function() {
		var data = {};
	    $("#dsImage").on("mousedown", function(event) {
	    	event.preventDefault();
	        var x_down = (event.pageX - this.offsetLeft) / this.width;
	        var y_down = (event.pageY - this.offsetTop) / this.height;
	        //console.log(x);
	        //console.log(y);

	        data['x_down'] = x_down;
	        data['y_down'] = y_down;});

			$("#dsImage").on("mouseup", function(event) {
			    var x_up = (event.pageX - this.offsetLeft) / this.width;
			    var y_up = (event.pageY - this.offsetTop) / this.height;
			    console.log("release mouse");
			    //console.log(x_high);
			    //console.log(y_high);

			    data['x_up'] = x_up;
			    data['y_up'] = y_up;
			console.log(data);

			$.ajax({
			    type: 'POST',
			    url: '/zoom',
			    dataType: 'json',
			    contentType: 'application/json; charset=utf-8',
			    data: JSON.stringify(data),
			    success: function(callback) {
			        // Watch out for Cross Site Scripting security issues when setting dynamic content!
			        $('#dsImage').attr('src', callback.newImage);;
			    },
			    error: function() {
			        $(this).html("error!");
			    }
			});
	    });
	});
	</script>
	<script type="text/javascript">
        $('#inputForm').submit(function(e) {
                e.preventDefault();

                var data = {};
                var Form = this;

                $.each(this.elements, function(i, v) {
                    var input = $(v);
                    data[input.attr("name")] = input.val();
                    delete data["undefined"];
                });

                $.ajax({
                    type: 'POST',
                    url: '/changeRange',
                    dataType: 'json',
                    contentType: 'application/json; charset=utf-8',
                    data: JSON.stringify(data),
                    context: Form,
                    success: function(callback) {
                        console.log('testing');
                        // Watch out for Cross Site Scripting security issues when setting dynamic content!
                        $('#dsImage').attr('src', callback.newImage);
                    },
                    error: function() {
                        $(this).html("error!");
                    }
                });
            });
    </script>
</body>