#!/usr/bin/env python

from pprint import pprint
from copy import copy
import timeit

powerTimeSeries = [['', '1 NoCVR', '2 CVR'],
	['2000-01-01 00:00:00 PST', 802.6916621231344, 789.8108313976202],
	['2000-01-02 00:00:00 PST', 2963.053382834842, 2786.378729518936],
	['2000-01-03 00:00:00 PST', 3135.32119447115, 3080.8286373740425],
	['2000-01-04 00:00:00 PST', 3320.9328644608277, 2986.834823504641],
	['2000-01-05 00:00:00 PST', 3005.585722468085, 3242.8626232765396],
	['2000-01-06 00:00:00 PST', 4585.93287916908, 5229.486220451202],
	['2000-01-07 00:00:00 PST', 2725.1169886381026, 3019.7522847795462],
	['2000-01-08 00:00:00 PST', 4588.213521949039, 4919.579141063695],
	['2000-01-09 00:00:00 PST', 2923.25663441717, 3797.3860486687418],
	['2000-01-10 00:00:00 PST', 2465.4045088238563, 2327.1534793404257],
	['2000-01-11 00:00:00 PST', 3983.326222004545, 3613.6699550906696],
	['2000-01-12 00:00:00 PST', 2319.677286543109, 2390.5137510804993],
	['2000-01-13 00:00:00 PST', 2799.386579157834, 2272.5571870310528],
	['2000-01-14 00:00:00 PST', 1731.0876820415538, 1619.9750430651732],
	['2000-01-15 00:00:00 PST', 2241.454373073206, 2043.386519153009],
	['2000-01-16 00:00:00 PST', 2068.053799127092, 2438.2026256094878],
	['2000-01-17 00:00:00 PST', 2919.637248122616, 2669.57042857642],
	['2000-01-18 00:00:00 PST', 2448.6477575192393, 2144.6517509144483],
	['2000-01-19 00:00:00 PST', 2836.5807352578563, 2154.775306999839],
	['2000-01-20 00:00:00 PST', 2770.547747563467, 2454.3896326037743],
	['2000-01-21 00:00:00 PST', 4038.08296885589, 3750.7221201604634],
	['2000-01-22 00:00:00 PST', 1469.4545952141564, 1417.6195335522857],
	['2000-01-23 00:00:00 PST', 2248.6506725645495, 2273.401719934249],
	['2000-01-24 00:00:00 PST', 4285.148671751775, 3615.939587524244],
	['2000-01-25 00:00:00 PST', 2804.133319405481, 2619.84987480886],
	['2000-01-26 00:00:00 PST', 3003.1827852170436, 2778.33669405928],
	['2000-01-27 00:00:00 PST', 2906.0560565276437, 2932.775046569546],
	['2000-01-28 00:00:00 PST', 3535.5683307123336, 3154.6932945216718],
	['2000-01-29 00:00:00 PST', 2869.974445896862, 2862.6750280959245],
	['2000-01-30 00:00:00 PST', 2478.6750394799637, 2519.904716199404],
	['2000-01-31 00:00:00 PST', 2843.2234040435515, 2834.2475479966456],
	['2000-02-01 00:00:00 PST', 2588.1096247124074, 2345.368740475416],
	['2000-02-02 00:00:00 PST', 2272.5538804228604, 1938.4200077180615],
	['2000-02-03 00:00:00 PST', 2947.4254519251203, 2506.573899421479],
	['2000-02-04 00:00:00 PST', 2369.2820396189645, 2088.007944262665],
	['2000-02-05 00:00:00 PST', 1760.7237426209144, 1722.4325077646467],
	['2000-02-06 00:00:00 PST', 2170.792541723875, 2010.2852976961478],
	['2000-02-07 00:00:00 PST', 2860.848745100132, 2489.92227644258],
	['2000-02-08 00:00:00 PST', 4401.6066543043125, 3968.804046724907],
	['2000-02-09 00:00:00 PST', 2542.1817948724674, 2395.845929303554],
	['2000-02-10 00:00:00 PST', 2008.3966574359758, 2023.313414254203],
	['2000-02-11 00:00:00 PST', 1982.8741112849298, 1958.070844587856],
	['2000-02-12 00:00:00 PST', 1622.4788343470002, 1572.4936223848413],
	['2000-02-13 00:00:00 PST', 2494.058326741578, 2282.776107697783],
	['2000-02-14 00:00:00 PST', 3201.3089610409365, 2952.643258661805],
	['2000-02-15 00:00:00 PST', 3108.945465128168, 3529.2349506589444],
	['2000-02-16 00:00:00 PST', 3269.4715437857844, 4109.15598392042],
	['2000-02-17 00:00:00 PST', 2665.187368500759, 2958.0874951792757],
	['2000-02-18 00:00:00 PST', 3563.4327395960486, 3109.349846760412],
	['2000-02-19 00:00:00 PST', 2151.1286703591213, 1881.8787559502364],
	['2000-02-20 00:00:00 PST', 2892.9089977406825, 2819.4163816869973],
	['2000-02-21 00:00:00 PST', 2705.27490146362, 2317.633362619638],
	['2000-02-22 00:00:00 PST', 2867.15622636856, 2541.824625752393],
	['2000-02-23 00:00:00 PST', 3051.4848390519655, 2580.627970643525],
	['2000-02-24 00:00:00 PST', 3458.433225251718, 2913.126556021897],
	['2000-02-25 00:00:00 PST', 3975.4676118842926, 3519.714350085245],
	['2000-02-26 00:00:00 PST', 1549.3209540508383, 1551.3885021898318],
	['2000-02-27 00:00:00 PST', 2672.822010583757, 2930.8173155172944],
	['2000-02-28 00:00:00 PST', 2902.856462689983, 2222.6389306713404],
	['2000-02-29 00:00:00 PST', 2819.6524970508335, 2385.668542249983],
	['2000-03-01 00:00:00 PST', 3191.270581291408, 2812.086567288603],
	['2000-03-02 00:00:00 PST', 3085.22708634243, 2868.406608119044],
	['2000-03-03 00:00:00 PST', 2689.8486957948026, 2476.1997849737404],
	['2000-03-04 00:00:00 PST', 2146.8190663223113, 1967.230494292762],
	['2000-03-05 00:00:00 PST', 1627.120411803933, 1535.9120068348836],
	['2000-03-06 00:00:00 PST', 2999.254816854513, 2933.080266004495],
	['2000-03-07 00:00:00 PST', 2641.423510791861, 3199.847296685329],
	['2000-03-08 00:00:00 PST', 2819.027341520653, 2863.065687238351],
	['2000-03-09 00:00:00 PST', 3142.5007454766023, 2890.7066985040183],
	['2000-03-10 00:00:00 PST', 2870.89585914728, 2356.5306738707413],
	['2000-03-11 00:00:00 PST', 2148.600986676912, 2311.599170848234],
	['2000-03-12 00:00:00 PST', 2725.7403252004765, 2349.1405985102297],
	['2000-03-13 00:00:00 PST', 3720.4215189335737, 3411.2024049506354],
	['2000-03-14 00:00:00 PST', 3835.9122414653857, 3523.5023474107406],
	['2000-03-15 00:00:00 PST', 3401.025832293692, 2986.744755505733],
	['2000-03-16 00:00:00 PST', 3179.834590443503, 2536.166731258219],
	['2000-03-17 00:00:00 PST', 3415.69841504545, 3102.1078034118996],
	['2000-03-18 00:00:00 PST', 2003.745725139794, 1849.5230985367552],
	['2000-03-19 00:00:00 PST', 2557.8584822589382, 2390.8886881112303],
	['2000-03-20 00:00:00 PST', 3095.102148712381, 2562.685843935811],
	['2000-03-21 00:00:00 PST', 3787.7864370247958, 3359.7053455289797],
	['2000-03-22 00:00:00 PST', 1822.6515714258169, 1911.7554492122783],
	['2000-03-23 00:00:00 PST', 2881.749673399131, 2606.005877129981],
	['2000-03-24 00:00:00 PST', 2781.0783645204965, 2579.1565667282475],
	['2000-03-25 00:00:00 PST', 2435.2260717346144, 2118.711319788366],
	['2000-03-26 00:00:00 PST', 2536.245965829024, 2536.8597850967244],
	['2000-03-27 00:00:00 PST', 434.4151036555244, 418.51915260594706],
	['2000-03-28 00:00:00 PST', 1272.8305047416957, 1271.9753968391055],
	['2000-03-29 00:00:00 PST', 3536.2376135751965, 3044.7480863284895],
	['2000-03-30 00:00:00 PST', 2027.1451453795803, 1965.6187356476332],
	['2000-03-31 00:00:00 PST', 1208.893725891569, 1149.9358475258523],
	['2000-04-01 00:00:00 PST', 1647.6531934145, 1654.4149469891163],
	['2000-04-02 00:00:00 PST', 2849.2824963165726, 2660.14229664505],
	['2000-04-03 01:00:00 PDT', 1881.0880503751014, 1944.058656661946],
	['2000-04-04 01:00:00 PDT', 3153.4023460694007, 2880.970993228498],
	['2000-04-05 01:00:00 PDT', 3080.407351804141, 2777.7906690875107],
	['2000-04-06 01:00:00 PDT', 1500.4517968585328, 1654.6865432102238],
	['2000-04-07 01:00:00 PDT', 547.1438106476213, 570.2640322145875],
	['2000-04-08 01:00:00 PDT', 1143.481531446993, 1613.1990956531063],
	['2000-04-09 01:00:00 PDT', 506.69031516468715, 426.9268989066981],
	['2000-04-10 01:00:00 PDT', 549.0245780384062, 558.4451346975457],
	['2000-04-11 01:00:00 PDT', 1980.4606986951294, 2231.7758111022263],
	['2000-04-12 01:00:00 PDT', 630.5384741187804, 825.4831139553613],
	['2000-04-13 01:00:00 PDT', 2118.0891685252536, 2590.5354136604656],
	['2000-04-14 01:00:00 PDT', 2310.4640295845334, 2741.663215379307],
	['2000-04-15 01:00:00 PDT', 1062.340989697677, 1599.824115883993],
	['2000-04-16 01:00:00 PDT', 360.0750269910564, 530.5809982585129],
	['2000-04-17 01:00:00 PDT', 835.7481808620107, 909.4937073366698],
	['2000-04-18 01:00:00 PDT', 1061.4482391167267, 1277.106011262965],
	['2000-04-19 01:00:00 PDT', 343.8778494038399, 325.83372067858477],
	['2000-04-20 01:00:00 PDT', 1051.3220079905536, 1125.610151084735],
	['2000-04-21 01:00:00 PDT', 760.9609368594423, 964.4507440895518],
	['2000-04-22 01:00:00 PDT', 458.53288972841415, 562.5335214775738],
	['2000-04-23 01:00:00 PDT', 483.29116770353875, 473.1567254240502],
	['2000-04-24 01:00:00 PDT', 663.3000138640132, 667.8881451635446],
	['2000-04-25 01:00:00 PDT', 525.3817446519149, 534.3092106509207],
	['2000-04-26 01:00:00 PDT', 501.25142462843934, 510.3765070703784],
	['2000-04-27 01:00:00 PDT', 600.5377086991623, 588.2203086740885],
	['2000-04-28 01:00:00 PDT', 891.5231481980711, 1082.4540277448275],
	['2000-04-29 01:00:00 PDT', 579.8361212867305, 682.5718629897441],
	['2000-04-30 01:00:00 PDT', 402.2094511899988, 396.7538496698425],
	['2000-05-01 01:00:00 PDT', 1709.9974498428353, 1623.108531510139],
	['2000-05-02 01:00:00 PDT', 2411.3526942228923, 2691.2198416881515],
	['2000-05-03 01:00:00 PDT', 1012.2668502825725, 1551.7935283136092],
	['2000-05-04 01:00:00 PDT', 1639.2477435668472, 1916.2045662426024],
	['2000-05-05 01:00:00 PDT', 839.3383475506168, 979.8918315557131],
	['2000-05-06 01:00:00 PDT', 382.62509628252303, 428.84955292503224],
	['2000-05-07 01:00:00 PDT', 311.59557295449497, 304.3435074902042],
	['2000-05-08 01:00:00 PDT', 546.300047212784, 666.5670601709928],
	['2000-05-09 01:00:00 PDT', 1681.6717606298798, 2007.4007546797923],
	['2000-05-10 01:00:00 PDT', 1489.2687782160076, 1836.5353609830113],
	['2000-05-11 01:00:00 PDT', 634.383123685279, 618.910086705654],
	['2000-05-12 01:00:00 PDT', 971.2102731586278, 881.7409736860877],
	['2000-05-13 01:00:00 PDT', 537.84167938266, 526.5004809230946],
	['2000-05-14 01:00:00 PDT', 432.10406733125063, 421.2201675286216],
	['2000-05-15 01:00:00 PDT', 731.0275218746709, 799.7451772139673],
	['2000-05-16 01:00:00 PDT', 543.5343730722465, 513.244799239739],
	['2000-05-17 01:00:00 PDT', 497.1732579946351, 492.4452242262179],
	['2000-05-18 01:00:00 PDT', 480.7551640704028, 482.2618269168315],
	['2000-05-19 01:00:00 PDT', 398.6138459459355, 370.2137208545896],
	['2000-05-20 01:00:00 PDT', 535.698111612352, 529.4714911509495],
	['2000-05-21 01:00:00 PDT', 454.10820879151703, 450.71591437693877],
	['2000-05-22 01:00:00 PDT', 282.3124380083401, 255.4464148674285],
	['2000-05-23 01:00:00 PDT', 343.5943811499397, 308.70353885895116],
	['2000-05-24 01:00:00 PDT', 280.3712715922257, 274.3418316664697],
	['2000-05-25 01:00:00 PDT', 283.2401318279286, 255.01652407619412],
	['2000-05-26 01:00:00 PDT', 386.64053605327007, 374.30992634211555],
	['2000-05-27 01:00:00 PDT', 404.9199881669958, 427.37323678467516],
	['2000-05-28 01:00:00 PDT', 369.9598520285681, 336.61209306958955],
	['2000-05-29 01:00:00 PDT', 316.95362390741013, 320.0097127813623],
	['2000-05-30 01:00:00 PDT', 759.1355862251222, 743.5779050195657],
	['2000-05-31 01:00:00 PDT', 493.76021791745234, 501.46090690465593],
	['2000-06-01 01:00:00 PDT', 372.14745751575407, 356.60171040358176],
	['2000-06-02 01:00:00 PDT', 376.35141960966484, 368.8992863971954],
	['2000-06-03 01:00:00 PDT', 469.3383462972102, 433.9626893507782],
	['2000-06-04 01:00:00 PDT', 319.35189019580406, 299.16109280422967],
	['2000-06-05 01:00:00 PDT', 282.43081604030556, 259.4570801823539],
	['2000-06-06 01:00:00 PDT', 297.6499216350839, 284.81486047190185],
	['2000-06-07 01:00:00 PDT', 308.8827357989436, 290.4888649792224],
	['2000-06-08 01:00:00 PDT', 1087.6375823724557, 1012.3337495890376],
	['2000-06-09 01:00:00 PDT', 856.5186954804665, 813.7816981727962],
	['2000-06-10 01:00:00 PDT', 292.0775996329758, 271.8974508617558],
	['2000-06-11 01:00:00 PDT', 292.2051325465768, 291.18212619630776],
	['2000-06-12 01:00:00 PDT', 277.5198470007551, 264.0502069561062],
	['2000-06-13 01:00:00 PDT', 293.23309245118224, 263.4393214046379],
	['2000-06-14 01:00:00 PDT', 274.1532346860641, 259.2217982994534],
	['2000-06-15 01:00:00 PDT', 282.6476262831591, 267.3186162840957],
	['2000-06-16 01:00:00 PDT', 292.05452918366115, 259.05011499794705],
	['2000-06-17 01:00:00 PDT', 1332.040778390812, 1302.0992424681],
	['2000-06-18 01:00:00 PDT', 296.56465084327493, 313.5582561614355],
	['2000-06-19 01:00:00 PDT', 286.956267865959, 258.3177521681328],
	['2000-06-20 01:00:00 PDT', 286.61557425773793, 272.9964143720053],
	['2000-06-21 01:00:00 PDT', 277.8850111359245, 258.5451415363445],
	['2000-06-22 01:00:00 PDT', 287.8573767469733, 268.5269278555162],
	['2000-06-23 01:00:00 PDT', 273.53931428804964, 259.0689100520431],
	['2000-06-24 01:00:00 PDT', 287.0075821544234, 281.1553866638306],
	['2000-06-25 01:00:00 PDT', 304.2718390714467, 294.896402140351],
	['2000-06-26 01:00:00 PDT', 273.37467878662426, 272.39242498802366],
	['2000-06-27 01:00:00 PDT', 268.9468577696761, 263.663103227767],
	['2000-06-28 01:00:00 PDT', 288.1787272666739, 263.91038975087656],
	['2000-06-29 01:00:00 PDT', 278.0425450359396, 263.3613913470811],
	['2000-06-30 01:00:00 PDT', 278.1368664733541, 267.8007252730291],
	['2000-07-01 01:00:00 PDT', 310.858227025444, 304.3780770914811],
	['2000-07-02 01:00:00 PDT', 502.2402279311764, 501.45005939962755],
	['2000-07-03 01:00:00 PDT', 757.0390264563645, 734.5571250481211],
	['2000-07-04 01:00:00 PDT', 299.67055847684736, 303.88725676042685],
	['2000-07-05 01:00:00 PDT', 285.6583340767421, 268.39980503586435],
	['2000-07-06 01:00:00 PDT', 303.855540677595, 275.90592934958994],
	['2000-07-07 01:00:00 PDT', 291.7609088256451, 282.58786678180576],
	['2000-07-08 01:00:00 PDT', 324.6365324698724, 276.6023289812739],
	['2000-07-09 01:00:00 PDT', 309.4210044899617, 299.7674134925651],
	['2000-07-10 01:00:00 PDT', 363.9018674587972, 334.73354625098455],
	['2000-07-11 01:00:00 PDT', 279.0319579841965, 263.0773431111484],
	['2000-07-12 01:00:00 PDT', 287.1458658953406, 270.5639860619029],
	['2000-07-13 01:00:00 PDT', 333.2477436067047, 282.58675898197515],
	['2000-07-14 01:00:00 PDT', 273.8827503982126, 251.047004703427],
	['2000-07-15 01:00:00 PDT', 305.1298845500152, 303.7583665858376],
	['2000-07-16 01:00:00 PDT', 310.15619237472094, 313.55928309591235],
	['2000-07-17 01:00:00 PDT', 427.10215462598643, 421.02755459481506],
	['2000-07-18 01:00:00 PDT', 512.8349482718197, 500.1823678159797],
	['2000-07-19 01:00:00 PDT', 378.585749238201, 352.7683585217926],
	['2000-07-20 01:00:00 PDT', 269.52912702131766, 267.3564206772046],
	['2000-07-21 01:00:00 PDT', 274.1807808836353, 278.82203126322156],
	['2000-07-22 01:00:00 PDT', 309.7524819057192, 275.9651609155011],
	['2000-07-23 01:00:00 PDT', 323.207179978578, 287.9306111151381],
	['2000-07-24 01:00:00 PDT', 385.2189857379306, 369.5424778985631],
	['2000-07-25 01:00:00 PDT', 282.4134847250536, 259.69308646201597],
	['2000-07-26 01:00:00 PDT', 278.540615884199, 262.5034493047472],
	['2000-07-27 01:00:00 PDT', 292.7485923670131, 267.1843955152501],
	['2000-07-28 01:00:00 PDT', 286.7772107959738, 258.8080953709362],
	['2000-07-29 01:00:00 PDT', 309.51975009018406, 296.53921330911294],
	['2000-07-30 01:00:00 PDT', 296.48289963374884, 299.0231619296206],
	['2000-07-31 01:00:00 PDT', 292.2977545763607, 275.87268085918254],
	['2000-08-01 01:00:00 PDT', 278.2018491810363, 279.79153103387546],
	['2000-08-02 01:00:00 PDT', 296.1729363976771, 271.09825398673524],
	['2000-08-03 01:00:00 PDT', 287.3257107440516, 254.4085143778832],
	['2000-08-04 01:00:00 PDT', 292.1118835090753, 267.0057397331376],
	['2000-08-05 01:00:00 PDT', 318.51809567435896, 296.9561550481958],
	['2000-08-06 01:00:00 PDT', 305.23243151676, 307.1950139888504],
	['2000-08-07 01:00:00 PDT', 273.7994906411777, 266.34027304225117],
	['2000-08-08 01:00:00 PDT', 281.3809678069652, 272.75434876272163],
	['2000-08-09 01:00:00 PDT', 273.55616879782184, 271.8793760982513],
	['2000-08-10 01:00:00 PDT', 282.25719710110917, 281.1853343513081],
	['2000-08-11 01:00:00 PDT', 263.96057007873355, 271.4366282960912],
	['2000-08-12 01:00:00 PDT', 322.64445842521394, 292.8121528821454],
	['2000-08-13 01:00:00 PDT', 314.4820613991202, 310.7347016515151],
	['2000-08-14 01:00:00 PDT', 282.45528785637487, 267.0568259748633],
	['2000-08-15 01:00:00 PDT', 297.3425641997734, 276.45874917263893],
	['2000-08-16 01:00:00 PDT', 277.5770759974766, 255.33752219061262],
	['2000-08-17 01:00:00 PDT', 264.50755436719083, 263.3613913470811],
	['2000-08-18 01:00:00 PDT', 282.4681324675123, 271.5907354138062],
	['2000-08-19 01:00:00 PDT', 324.6065148266783, 291.87548317766533],
	['2000-08-20 01:00:00 PDT', 300.6863966689042, 317.6246170213954],
	['2000-08-21 01:00:00 PDT', 330.82647629535336, 306.8538809971938],
	['2000-08-22 01:00:00 PDT', 278.7240586376885, 271.31553517902523],
	['2000-08-23 01:00:00 PDT', 283.22352176824734, 284.06208389760434],
	['2000-08-24 01:00:00 PDT', 287.95566477195683, 259.06478120186773],
	['2000-08-25 01:00:00 PDT', 268.9901414949866, 272.2653679866613],
	['2000-08-26 01:00:00 PDT', 309.61472332099515, 317.394273498499],
	['2000-08-27 01:00:00 PDT', 333.321006904345, 284.0069574457809],
	['2000-08-28 01:00:00 PDT', 357.1623304540388, 337.01509856438184],
	['2000-08-29 01:00:00 PDT', 282.88410616980394, 271.2094535851588],
	['2000-08-30 01:00:00 PDT', 291.41507368912147, 274.15641538752453],
	['2000-08-31 01:00:00 PDT', 268.7861135072934, 282.79856224849675],
	['2000-09-01 01:00:00 PDT', 278.52192422244985, 274.7566683378156],
	['2000-09-02 01:00:00 PDT', 381.77538295926047, 376.7885460249024],
	['2000-09-03 01:00:00 PDT', 295.85660329604343, 280.21196431252696],
	['2000-09-04 01:00:00 PDT', 277.93469054086086, 270.8291372526228],
	['2000-09-05 01:00:00 PDT', 282.67566643266076, 266.51101855762005],
	['2000-09-06 01:00:00 PDT', 278.32395203371357, 271.3667880246264],
	['2000-09-07 01:00:00 PDT', 277.9208984627418, 263.07729051989645],
	['2000-09-08 01:00:00 PDT', 268.9468577696761, 267.69035247942725],
	['2000-09-09 01:00:00 PDT', 337.5136365572739, 287.1413542684794],
	['2000-09-10 01:00:00 PDT', 310.11412969307946, 285.6684924673089],
	['2000-09-11 01:00:00 PDT', 290.50224366732886, 258.8598599742718],
	['2000-09-12 01:00:00 PDT', 282.6804407450804, 264.59978826440806],
	['2000-09-13 01:00:00 PDT', 310.03322219130405, 276.42443666709806],
	['2000-09-14 01:00:00 PDT', 278.6846346707016, 271.376616752421],
	['2000-09-15 01:00:00 PDT', 287.5473435328104, 251.04700479270332],
	['2000-09-16 01:00:00 PDT', 410.8533747024113, 365.7745095869312],
	['2000-09-17 01:00:00 PDT', 429.25401919777056, 419.6266238848055],
	['2000-09-18 01:00:00 PDT', 291.97985711860764, 279.2861543109225],
	['2000-09-19 01:00:00 PDT', 283.4370808754345, 263.5123354211442],
	['2000-09-20 01:00:00 PDT', 364.1710132684918, 334.12242493583096],
	['2000-09-21 01:00:00 PDT', 487.03997836419956, 440.31160149303355],
	['2000-09-22 01:00:00 PDT', 282.6464836764627, 271.53297557618316],
	['2000-09-23 01:00:00 PDT', 743.4763748189985, 684.9924512357782],
	['2000-09-24 01:00:00 PDT', 628.7940509674133, 659.2942919602444],
	['2000-09-25 01:00:00 PDT', 373.2651196900803, 377.29018961988663],
	['2000-09-26 01:00:00 PDT', 282.6841178407623, 260.02216148245594],
	['2000-09-27 01:00:00 PDT', 518.5708103856214, 401.10354399002756],
	['2000-09-28 01:00:00 PDT', 482.1691069855471, 434.3551454718708],
	['2000-09-29 01:00:00 PDT', 292.5791451197917, 266.9501154368464],
	['2000-09-30 01:00:00 PDT', 328.3272197343986, 295.6030530515923],
	['2000-10-01 01:00:00 PDT', 388.0949807036834, 329.00108265127653],
	['2000-10-02 01:00:00 PDT', 312.4836183051067, 303.4965193927495],
	['2000-10-03 01:00:00 PDT', 404.5498723648791, 343.1493942617996],
	['2000-10-04 01:00:00 PDT', 308.2949593610199, 299.5107292179032],
	['2000-10-05 01:00:00 PDT', 406.7754327201804, 388.80256537121767],
	['2000-10-06 01:00:00 PDT', 299.2754019577954, 292.12793858936595],
	['2000-10-07 01:00:00 PDT', 409.4288522363318, 400.2844113557759],
	['2000-10-08 01:00:00 PDT', 2234.339949631839, 2543.180697250787],
	['2000-10-09 01:00:00 PDT', 1607.682118929299, 1862.4242600503246],
	['2000-10-10 01:00:00 PDT', 562.3954022464001, 587.2632776761118],
	['2000-10-11 01:00:00 PDT', 322.8396925673793, 301.1644129824905],
	['2000-10-12 01:00:00 PDT', 1047.9665883361931, 975.4741378252116],
	['2000-10-13 01:00:00 PDT', 452.24036689194384, 432.0013325796114],
	['2000-10-14 01:00:00 PDT', 424.2510529587522, 442.25413802473344],
	['2000-10-15 01:00:00 PDT', 600.583168322956, 603.8420170197168],
	['2000-10-16 01:00:00 PDT', 1181.8286610879768, 1152.7175318997279],
	['2000-10-17 01:00:00 PDT', 914.3517316683991, 918.6269755353638],
	['2000-10-18 01:00:00 PDT', 2732.6347843215344, 2041.5089362349825],
	['2000-10-19 01:00:00 PDT', 1059.5276714914057, 1132.4466117963352],
	['2000-10-20 01:00:00 PDT', 1630.9495770259116, 1767.923702068616],
	['2000-10-21 01:00:00 PDT', 1278.1199429728808, 1658.6001628405093],
	['2000-10-22 01:00:00 PDT', 714.9706523591144, 663.4713058411494],
	['2000-10-23 01:00:00 PDT', 944.9581223916751, 916.6223581097562],
	['2000-10-24 01:00:00 PDT', 607.2467368640198, 697.2621793372203],
	['2000-10-25 01:00:00 PDT', 634.7545441200401, 570.4922204449769],
	['2000-10-26 01:00:00 PDT', 891.3167919208074, 829.3178931605479],
	['2000-10-27 01:00:00 PDT', 499.7775275839141, 506.467806441831],
	['2000-10-28 01:00:00 PDT', 691.0549187872191, 628.9193039787855],
	['2000-10-29 01:00:00 PDT', 587.4759489638363, 562.0042463643936],
	['2000-10-30 00:00:00 PST', 520.1098200557648, 487.58706456304805],
	['2000-10-31 00:00:00 PST', 622.06916232792, 604.023031379599],
	['2000-11-01 00:00:00 PST', 2901.5468648741485, 2711.282945221505],
	['2000-11-02 00:00:00 PST', 4130.383966701401, 3431.3485770992434],
	['2000-11-03 00:00:00 PST', 2664.8999632001196, 2450.7485606950786],
	['2000-11-04 00:00:00 PST', 1558.9940496682468, 1552.0590485058872],
	['2000-11-05 00:00:00 PST', 2391.3045061741927, 2275.746108026992],
	['2000-11-06 00:00:00 PST', 2502.042862802314, 2255.7954592130222],
	['2000-11-07 00:00:00 PST', 2356.730952587503, 2259.3051589920315],
	['2000-11-08 00:00:00 PST', 1682.4607803678514, 1713.5097717066017],
	['2000-11-09 00:00:00 PST', 3135.8733731675134, 2877.878328583557],
	['2000-11-10 00:00:00 PST', 3086.8813706658702, 2666.247547584432],
	['2000-11-11 00:00:00 PST', 1490.1050760939645, 1295.1117206388028],
	['2000-11-12 00:00:00 PST', 1600.053716109556, 1537.932128606461],
	['2000-11-13 00:00:00 PST', 2019.9952337876937, 1853.0720626689076],
	['2000-11-14 00:00:00 PST', 2983.6068549659826, 2862.6324924413348],
	['2000-11-15 00:00:00 PST', 2955.75229921318, 2508.630926277686],
	['2000-11-16 00:00:00 PST', 3613.41616704968, 3391.2041526131984],
	['2000-11-17 00:00:00 PST', 3784.276367802568, 3255.2691633935588],
	['2000-11-18 00:00:00 PST', 2226.626263799338, 2203.832282484765],
	['2000-11-19 00:00:00 PST', 3188.86273453421, 2490.802708305114],
	['2000-11-20 00:00:00 PST', 4002.022798937557, 3479.2805213901624],
	['2000-11-21 00:00:00 PST', 3764.2048478269617, 3333.034718935433],
	['2000-11-22 00:00:00 PST', 2475.7080517387344, 2449.052476101931],
	['2000-11-23 00:00:00 PST', 2497.4574209033076, 2319.712509692742],
	['2000-11-24 00:00:00 PST', 2563.5643021278015, 2460.8607063908707],
	['2000-11-25 00:00:00 PST', 1698.8628321615608, 1617.052212353083],
	['2000-11-26 00:00:00 PST', 3082.376401585147, 2975.067452092473],
	['2000-11-27 00:00:00 PST', 3233.336954059846, 2881.5166365321506],
	['2000-11-28 00:00:00 PST', 2687.9258769223898, 2425.8301113019766],
	['2000-11-29 00:00:00 PST', 2350.0331767436815, 2169.942033393798],
	['2000-11-30 00:00:00 PST', 2898.6124165193246, 2396.3570753508334],
	['2000-12-01 00:00:00 PST', 3485.081976507296, 3288.4206046977934],
	['2000-12-02 00:00:00 PST', 4527.315365264938, 4200.375159257087],
	['2000-12-03 00:00:00 PST', 2329.369977369203, 2683.49141694845],
	['2000-12-04 00:00:00 PST', 3712.446790412086, 3493.0026164005376],
	['2000-12-05 00:00:00 PST', 2866.8008558593674, 2429.9541476538216],
	['2000-12-06 00:00:00 PST', 2580.0854039477063, 2463.980951064752],
	['2000-12-07 00:00:00 PST', 3263.7220150766516, 2682.299401104137],
	['2000-12-08 00:00:00 PST', 2922.7600029191585, 2543.9891723514547],
	['2000-12-09 00:00:00 PST', 1921.4481063221563, 1572.8768243384477],
	['2000-12-10 00:00:00 PST', 3173.408318814961, 2790.107862985245],
	['2000-12-11 00:00:00 PST', 4297.823722371126, 4284.041716183562],
	['2000-12-12 00:00:00 PST', 6288.218916300227, 5859.979493512243],
	['2000-12-13 00:00:00 PST', 3489.455381144169, 4179.897379544742],
	['2000-12-14 00:00:00 PST', 2616.5434728022387, 2442.4897710055634],
	['2000-12-15 00:00:00 PST', 2334.168366622468, 2105.8003054435744],
	['2000-12-16 00:00:00 PST', 1998.1643264779302, 1717.1688240866827],
	['2000-12-17 00:00:00 PST', 2375.056188995115, 2048.161042491359],
	['2000-12-18 00:00:00 PST', 3182.92240209591, 2904.8479396099206],
	['2000-12-19 00:00:00 PST', 2687.0046227790526, 2560.836619718056],
	['2000-12-20 00:00:00 PST', 2750.634551524611, 2600.424854888045],
	['2000-12-21 00:00:00 PST', 3881.157928688937, 3517.673964067165],
	['2000-12-22 00:00:00 PST', 3118.3587198358045, 2793.4922027399684],
	['2000-12-23 00:00:00 PST', 1605.230998251965, 1530.829191968183],
	['2000-12-24 00:00:00 PST', 2877.6712807921617, 2691.804578556967],
	['2000-12-25 00:00:00 PST', 2511.8738612336806, 2260.983671990614],
	['2000-12-26 00:00:00 PST', 2957.840990228515, 2921.5408490014306],
	['2000-12-27 00:00:00 PST', 2519.4209068188666, 2277.1557308407782],
	['2000-12-28 00:00:00 PST', 2399.6140684120437, 2232.0394121346176],
	['2000-12-29 00:00:00 PST', 2250.251995088772, 2131.204776566766],
	['2000-12-30 00:00:00 PST', 1731.905390157326, 1585.9142573168956]]

def processMonths(inList, listFunc):
	# Given a month chunk, replace values so they're all equal to the listFunc ones.
	def peakPower(monthList):
		colForm = zip(*monthList)
		header = colForm[0]
		def replaceWithMax(inList):
			maximum = listFunc(inList)
			return map(lambda x:maximum, inList)
		peaks = [header] + map(replaceWithMax, colForm[1:])
		return [list(x) for x in zip(*peaks)]
	# Walk the full inList, split it into months, and process each month chunk.
	workList = copy(inList)
	monthYear = workList[0][0][0:7]
	startRow = 0
	for rowNum in xrange(len(inList)):
		if workList[rowNum][0][0:7] == monthYear and rowNum != len(inList)-1:
			pass
		else:
			monthYear = workList[rowNum][0][0:7]
			print '-----------------------------------------------------'
			pprint(workList[startRow])
			pprint(workList[rowNum-1])
			fudge = (1 if rowNum == len(inList)-1 else 0)
			workList[startRow:rowNum+fudge] = peakPower(workList[startRow:rowNum+fudge])
			startRow = rowNum
	return workList

monetizedPower = processMonths(powerTimeSeries[1:], lambda z:max(z)/len(z)*45.0)

# pprint(monetizedPower)

def procMonAlt(inList, listFunc):
	# get monthly proc'd months.
	monthList = set([row[0][0:7] for row in inList])
	# for each month, this function calculates the listFunc of each column.
	def funcMon(month):
		listMatr = [row for row in inList if row[0][0:7]==month]
		transposedNoHeaders = [list(colRow) for colRow in zip(*listMatr)[1:]]
		return map(listFunc, transposedNoHeaders)
	# find the processed version for each month
	monthVects = {month:funcMon(month) for month in monthList}
	# return the rewritten matrix.
	return [[row[0]] + monthVects[row[0][0:7]] for row in inList]

altMonPower = procMonAlt(powerTimeSeries[1:],lambda z:max(z)/len(z)*45.0)

print altMonPower == monetizedPower

pprint(altMonPower[34])
pprint(monetizedPower[34])

# TIMING TEST!
print 'Original Time: ' + str(timeit.timeit('monetizedPower = processMonths(powerTimeSeries[1:], lambda z:max(z)/len(z)*45.0)', number=100, setup='from __main__ import processMonths, powerTimeSeries, procMonAlt'))
print 'Challengers Time: ' + str(timeit.timeit('altMonPower = procMonAlt(powerTimeSeries[1:],lambda z:max(z)/len(z)*45.0)', number=100, setup='from __main__ import processMonths, powerTimeSeries, procMonAlt'))